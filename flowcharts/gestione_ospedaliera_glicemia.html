<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Protocollo Emergenze Iperglicemiche</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.3;
            background: white;
            color: #1a1a1a;
            padding: 2px;
            font-size: 13px;
            overflow-x: hidden;
        }
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
        }
        .main-header {
            background: #d32f2f;
            color: white;
            text-align: center;
            font-weight: bold;
            font-size: clamp(12px, 5vw, 18px);
            padding: 8px 4px;
            margin-bottom: 6px;
            border-radius: 4px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        .back-link {
            display: inline-block;
            background: #1976d2;
            color: white;
            text-decoration: none;
            padding: 6px 12px;
            border-radius: 4px;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: clamp(11px, 3.5vw, 14px);
        }
        .back-link:hover {
            background: #1565c0;
        }
        .back-link::before {
            content: "‚Üê ";
        }
        .section {
            margin-bottom: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .section-title {
            background: #1976d2;
            color: white;
            font-weight: bold;
            font-size: clamp(11px, 4vw, 15px);
            padding: 6px 8px;
            text-align: center;
        }
        .section-title.emergency {
            background: #d32f2f;
        }
        .section-title.success {
            background: #388e3c;
        }
        .section-title.warning {
            background: #f57c00;
        }
        .section-content {
            padding: 8px;
            font-size: clamp(9px, 3vw, 13px);
        }
        .mermaid-container {
            background: #fafafa;
            border-radius: 6px;
            padding: 6px;
            margin: 8px 0;
            overflow-x: auto;
            touch-action: pan-x pan-y;
        }
        .mermaid {
            min-width: 100%;
            font-size: 11px;
        }
        .mermaid svg {
            width: 100%;
            height: auto;
            min-width: 100%;
        }
        .instructions {
            background: #e3f2fd;
            border-left: 3px solid #1976d2;
            padding: 8px;
            margin: 8px 0;
            border-radius: 3px;
        }
        .instructions h3 {
            color: #1976d2;
            margin-bottom: 4px;
            font-size: clamp(10px, 3.5vw, 14px);
        }
        .instructions p {
            font-size: clamp(9px, 3vw, 12px);
            line-height: 1.3;
            margin-bottom: 4px;
        }
        .box-nav {
            background: #f8f9fa;
            border: 1px solid #28a745;
            border-radius: 4px;
            padding: 8px;
            margin: 8px 0;
        }
        .box-nav h3 {
            color: #28a745;
            margin-bottom: 6px;
            font-size: clamp(10px, 3.5vw, 14px);
        }
        .box-nav-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 4px;
        }
        .box-nav-item {
            background: #28a745;
            color: white;
            text-decoration: none;
            padding: 6px 8px;
            border-radius: 3px;
            font-weight: 500;
            text-align: center;
            font-size: clamp(9px, 3vw, 12px);
            display: block;
        }
        .box-content {
            background: white;
            border: 1px solid #eee;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 10px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .box-content h2 {
            color: #d32f2f;
            margin-bottom: 8px;
            font-size: clamp(12px, 4vw, 16px);
            border-bottom: 1px solid #d32f2f;
            padding-bottom: 4px;
        }
        .box-content h3 {
            color: #1976d2;
            margin: 10px 0 4px 0;
            font-size: clamp(11px, 3.5vw, 14px);
        }
        .box-content ul, .box-content ol {
            padding-left: 16px;
            margin-bottom: 6px;
        }
        .box-content li {
            margin-bottom: 3px;
            font-size: clamp(9px, 3vw, 12px);
            line-height: 1.3;
        }
        .clinical-table {
            width: 100%;
            border-collapse: collapse;
            margin: 6px 0;
            font-size: clamp(8px, 2.5vw, 11px);
            background: white;
            border-radius: 4px;
            overflow: hidden;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .clinical-table th, .clinical-table td {
            border: 1px solid #ddd;
            padding: 4px 6px;
            text-align: left;
        }
        .clinical-table th {
            background: #e3f2fd;
            font-weight: bold;
            color: #1976d2;
        }
        .clinical-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        .critical-info {
            background: #ffebee;
            border: 1px solid #f44336;
            border-radius: 4px;
            padding: 8px;
            margin: 6px 0;
            color: #c62828;
            font-weight: bold;
            font-size: clamp(9px, 3vw, 12px);
        }
        .critical-info::before {
            content: "‚ö†Ô∏è ";
            font-size: 12px;
        }
        .clinical-pearl {
            background: #fff9c4;
            border: 1px solid #fbc02d;
            border-radius: 4px;
            padding: 6px 8px;
            margin: 6px 0;
            font-weight: bold;
            font-size: clamp(9px, 3vw, 12px);
        }
        .clinical-pearl::before {
            content: "üí° ";
            color: #f57c00;
        }
        .dosage-alert {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 4px;
            padding: 6px 8px;
            margin: 6px 0;
            font-weight: bold;
            color: #2e7d32;
            font-size: clamp(9px, 3vw, 12px);
        }
        .dosage-alert::before {
            content: "üíä ";
        }
        .precipitating-factors {
            background: #fff3e0;
            border-left: 3px solid #ff9800;
            padding: 8px;
            margin: 8px 0;
            border-radius: 3px;
            font-size: clamp(9px, 3vw, 12px);
        }
        .footer-section {
            background: #f8f9fa;
            border-top: 1px solid #ddd;
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
            font-size: clamp(8px, 2.5vw, 11px);
        }
        @media print {
            .back-link, .box-nav {
                display: none;
            }
            body {
                font-size: 8px;
            }
            .clinical-table {
                font-size: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-header">
            ü©∏ PROTOCOLLO EMERGENZE IPERGLICEMICHE ADULTO
        </div>

        <a href="#" class="back-link">
            Torna alla guida principale
        </a>

        <div class="instructions">
            <h3>üìã Guida rapida</h3>
            <p>Questo protocollo fornisce un approccio strutturato per il trattamento delle emergenze iperglicemiche. Usa il diagramma per identificare lo scenario clinico, poi consulta le BOX per i dettagli terapeutici.</p>
        </div>

        <div class="box-nav">
            <h3>üîç Sezioni del protocollo</h3>
            <div class="box-nav-grid">
                <a href="#box1" class="box-nav-item">BOX 1: Disidratazione</a>
                <a href="#box2" class="box-nav-item">BOX 2: Potassiemia</a>
                <a href="#box3" class="box-nav-item">BOX 3: Insulina EV</a>
                <a href="#box3bis" class="box-nav-item">BOX 3bis: Insulina SC</a>
                <a href="#box4" class="box-nav-item">BOX 4: Monitoraggio</a>
                <a href="#box5" class="box-nav-item">BOX 5: Fine Protocollo</a>
            </div>
        </div>

        <div class="section">
            <div class="section-title">üìä ALGORITMO DECISIONALE</div>
            <div class="section-content">
                <div class="mermaid-container">
                    <div class="mermaid">
flowchart TD
    subgraph Scenarios["üéØ SCENARI CLINICI"]
        A[üü° IPERGLICEMIA\n>250 mg/dl\nNo chetosi/acidosi]
        B[üü† IPERGLICEMIA + CHETOSI\n>250 mg/dl\nKetonemia >3\npH >7.3]
        C[üî¥ DKA\n>250 mg/dl\npH <7.3\nHCO3‚Åª <15]
        D[üö® HSS\n>600 mg/dl\nOsm >320\nNeuro alterato]
    end

    A --> Step1
    B --> Step1
    C --> Step1
    D --> Step1

    Step1[üè• STEP 1\nSF 0.9% 500-1000 ml/1h\nAccesso venoso\nüíä BOX 1]

    Step1 --> Step2[üî¨ STEP 2\nEGA, elettroliti\nOsmolarit√†\nFattori precipitanti]

    Step2 --> PathA{üü° Iperglicemia semplice}
    Step2 --> PathB{üü† Con chetosi}
    Step2 --> PathC{üî¥ DKA}
    Step2 --> PathD{üö® HSS}

    PathA --> TreatA[üíß SF 0.9% + K\nInsulina SC se needed\nüíä BOX 1,2,3bis]
    PathB --> TreatB[üíâ SF 0.9%\nK+ correzione\nInsulina SC\nüíä BOX 1,2,3bis]
    PathC --> TreatC[üö® SF 0.9%\nInsulina EV\nK+ aggressivo\nüíä BOX 1,2,3]
    PathD --> TreatD[‚ö° SF 0.9%/emitonica\nInsulina EV cautela\nMonitor neuro\nüíä BOX 1,2,3]

    TreatA --> Monitor
    TreatB --> Monitor
    TreatC --> Monitor
    TreatD --> Monitor

    Monitor[üìà MONITORAGGIO\nGlicemia/ketonemia 1h\nElettroliti 2-4h\nüíä BOX 4]

    Monitor --> ExitCriteria{‚úÖ CRITERI USCITA\nKetonemia <0.6\nHCO3‚Åª >15\nOsm normale\nAlimentazione}

    ExitCriteria -->|S√¨| Exit[üéØ TRANSIZIONE\nBasal-bolus\nFattori precipitanti\nüíä BOX 5]
    ExitCriteria -->|No| Monitor

    classDef mild fill:#fff3e0,stroke:#ff9800
    classDef ketosis fill:#fff3e0,stroke:#f57c00
    classDef dka fill:#ffebee,stroke:#d32f2f
    classDef hss fill:#f3e5f5,stroke:#7b1fa2
    classDef treatment fill:#e8f5e8,stroke:#2e7d32
    classDef monitoring fill:#e3f2fd,stroke:#1976d2

    class A mild
    class B ketosis
    class C dka
    class D hss
    class Step1,Step2,TreatA,TreatB,TreatC,TreatD treatment
    class Monitor,Exit monitoring
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title warning">üîç FATTORI PRECIPITANTI</div>
            <div class="section-content">
                <div class="precipitating-factors">
                    <strong>Infezioni</strong> (UTI, polmoniti, sepsi)<br/>
                    <strong>Farmaci</strong> (corticosteroidi, tiazidici)<br/>
                    <strong>Patologie acute</strong> (IMA, ictus, pancreatite)<br/>
                    <strong>Non aderenza</strong> (omissione insulina)<br/>
                    <strong>Stress</strong> (chirurgia, traumi)<br/>
                    <strong>Sostanze</strong> (alcol, cocaina)
                </div>
            </div>
        </div>

        <div class="box-content" id="box1">
            <h2>BOX 1 - DISIDRATAZIONE</h2>
            <div class="critical-info">
                Priorit√† assoluta: reidratazione con SF 0.9% (1L/1h iniziale). Monitorare segni di sovraccarico.
            </div>
            <h3>üìä Schema infusione</h3>
            <table class="clinical-table">
                <thead><tr><th>Fase</th><th>Velocit√†</th><th>Volume</th><th>K+</th></tr></thead>
                <tbody>
                    <tr><td>Ora 1</td><td>1000 ml/h</td><td>1000 ml</td><td>No</td></tr>
                    <tr><td>Ore 2-3</td><td>500 ml/h</td><td>1000 ml</td><td>BOX 2</td></tr>
                    <tr><td>Ore 4-9</td><td>250 ml/h</td><td>2000 ml</td><td>BOX 2</td></tr>
                </tbody>
            </table>
            <div class="clinical-pearl">
                In HSS, se osmolarit√† non scende con SF 0.9%, passare a emitonica 0.45%.
            </div>
        </div>

        <div class="box-content" id="box2">
            <h2>BOX 2 - POTASSIEMIA</h2>
            <div class="critical-info">
                Correggere K+ prima dell'insulina. Mai somministrare K+ se anuria/oliguria.
            </div>
            <h3>üìä Supplementazione K+</h3>
            <table class="clinical-table">
                <thead><tr><th>K+ (mEq/L)</th><th>Supplemento</th><th>Velocit√† max</th></tr></thead>
                <tbody>
                    <tr><td>>5.5</td><td>‚ùå Nessuno</td><td>-</td></tr>
                    <tr><td>3.5-5.5</td><td>KCl 20-40 mEq/L</td><td>20 mEq/h</td></tr>
                    <tr><td><3.5</td><td>üö® KCl 40 mEq/L</td><td>40 mEq/h</td></tr>
                </tbody>
            </table>
            <div class="dosage-alert">
                Dose max: 0.5 mmol/kg/h (es. 35 mEq/h per 70 kg).
            </div>
        </div>

        <div class="box-content" id="box3">
            <h2>BOX 3 - INSULINA EV</h2>
            <div class="critical-info">
                Solo se K+ >3.3 mEq/L. Usare insulina rapida (Actrapid/Humulin R).
            </div>
            <h3>üíâ Dosaggio</h3>
            <ul>
                <li>Bolo: 0.1 UI/kg/h</li>
                <li>Target: ‚Üì glicemia 50-90 mg/dl/h</li>
                <li>A 250 mg/dl: ‚Üì velocit√† + glucosata 5%</li>
            </ul>
            <div class="clinical-pearl">
                Overlap 1-2h tra EV e prima dose SC per evitare ricaduta.
            </div>
        </div>

        <div class="box-content" id="box3bis">
            <h2>BOX 3bis - INSULINA SC</h2>
            <div class="instructions">
                <h3>üìã Quando usare</h3>
                <p>Iperglicemia semplice o chetosi lieve (pH >7.25).</p>
            </div>
            <div class="dosage-alert">
                Schema: 0.2-0.3 UI/kg come dose di carico, poi 0.1 UI/kg ogni 1-2h.
            </div>
        </div>

        <div class="box-content" id="box4">
            <h2>BOX 4 - MONITORAGGIO</h2>
            <div class="critical-info">
                Glicemia/ketonemia ogni 1h; elettroliti ogni 2-4h. Attenzione a edema cerebrale.
            </div>
            <h3>üéØ Target</h3>
            <ul>
                <li>Glicemia: ‚Üì 50-90 mg/dl/h</li>
                <li>Osmolarit√†: ‚Üì 3-8 mOsm/kg/h</li>
                <li>Ketonemia: <0.6 mmol/L</li>
            </ul>
        </div>

        <div class="box-content" id="box5">
            <h2>BOX 5 - FINE PROTOCOLLO</h2>
            <div class="instructions">
                <h3>‚úÖ Criteri risoluzione</h3>
                <p>Ketonemia <0.6, pH >7.30, HCO3‚Åª >15, osmolarit√† normale, alimentazione.</p>
            </div>
            <h3>üîÑ Transizione</h3>
            <ul>
                <li>Basal-bolus: 0.3-0.5 UI/kg/die</li>
                <li>Consulenza diabetologica entro 48h</li>
            </ul>
        </div>

        <div class="footer-section">
            <h3>üìö RIFERIMENTI</h3>
            <p>ADA 2024, JBDS Guidelines, EASD Position Statements</p>
            <p><strong>Aggiornato:</strong> Settembre 2025</p>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis',
                nodeSpacing: 30,
                rankSpacing: 50,
                diagramPadding: 6
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.box-nav-item');
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    document.querySelector(targetId).scrollIntoView({ behavior: 'smooth' });
                });
            });
        });
    </script>
</body>
</html>
